var myApp=angular.module("MeanApp",["ui.router"]);myApp.config(function(e,o){o.otherwise("/"),e.state("app",{url:"/",views:{"header@":{templateUrl:"view/header.html",controller:"NavController"},content:{templateUrl:"view/home.html",controller:"HomeController"},footer:{templateUrl:"view/footer.html"}}}).state("app.aboutus",{url:"aboutus",views:{"header@":{templateUrl:"view/header.html",controller:"NavController"},"content@":{templateUrl:"view/aboutus.html",controller:"AboutUsController"}}}).state("app.login",{url:"login",views:{"header@":{templateUrl:"view/header.html",controller:"NavController"},"content@":{templateUrl:"view/login.html",controller:"LoginController"}}}).state("app.signup",{url:"signup",views:{"header@":{templateUrl:"view/header.html",controller:"NavController"},"content@":{templateUrl:"view/signup.html",controller:"SignupController"}}}).state("app.profile",{url:"profile",views:{"header@":{templateUrl:"view/header.html",controller:"NavController"},"content@":{templateUrl:"view/profile.html",controller:"ProfileController"}}})}),angular.module("MeanApp").controller("NavController",["$scope","authentication","$location",function(e,o,t){console.log("Running NavController"),e.isLoggedIn=o.isLoggedIn(),e.user=o.getUser(),console.log("isloggedin is "+e.isLoggedIn),e.login=function(){console.log("this is not implemented yet")},e.logout=function(){o.logout(),t.path("/")}}]).controller("HomeController",["$scope",function(e){console.log("Running HomeController")}]).controller("AboutUsController",["$scope",function(e){console.log("Running AboutusController")}]).controller("LoginController",["$scope",function(e){console.log("Running LoginController")}]).controller("SignupController",["$scope","$location","authentication",function(e,o,t){console.log("Running SignupController");var n={firstName:"",lastName:"",email:"",password:""};e.dataloading=!1,e.user=n,e.register=function(){e.dataloading=!0,t.register(n).success(function(e){console.log("Registration Successful"),o.path("/profile")}).error(function(t){console.log("Registraion failed: "+t.message),alert("Registraion failed: "+t.message),o.path("/signup"),e.dataloading=!1})}}]).controller("ProfileController",["$scope","authentication","userProfilesvc","$location",function(e,o,t,n){console.log("Running ProfileController");var l=o.isLoggedIn();l?t.getProfile().success(function(o){e.user=o}).error(function(e){console.log(e)}):console.log("User is no longer logged in"),e.tokenValid=l}]),angular.module("MeanApp").service("authentication",["$http","$window",function(e,o){console.log("Running authentication");var t={},n=function(e){t=e},l=function(e){return o.localStorage["mean-app-token"]},r=function(){o.localStorage.removeItem("mean-app-token")},i=function(e){o.localStorage["mean-app-token"]=e},a=function(o){return console.log(o),e.post("/api/register",o).success(function(e){console.log("data is "+e),i(e.token)})},s=function(o){return e.post("/api/login",o).success(function(e){i(e.token)})},c=function(e){var t="",n="",l="";return e&&(t=e.split(".")[1],n=o.atob(t),l=JSON.parse(n)),l},u=function(){var e,o=l();return!!o&&(e=c(o),e.exp>Date.now()/1e3)},g=function(){var e,o=l();if(o)return e=c(o),{firstname:e.firstname,lastname:e.lastname,email:e.email}},p=function(){r()};this.setUser=n,this.getToken=l,this.removeToken=r,this.saveToken=i,this.register=a,this.login=s,this.parseToken=c,this.isLoggedIn=u,this.getUser=g,this.logout=p}]).service("userProfilesvc",["$http","authentication",function(e,o){var t=function(){var t=o.getToken();return e.get("/api/profile",{headers:{Authorization:"Bearer "+t}})};this.getProfile=t}]);